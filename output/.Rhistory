Mat[i,j]= x
Mat[j,i]= x
}}
} else {
for(i in colnames(preds)){
for(j in colnames(preds)){
x= sum(preds[,i] != preds[,j])
Mat[i,j]= x
Mat[j,i]= x
}}
}
return(Mat)}
library(gplots)
library("RColorBrewer")
my_palette1 <- colorRampPalette(c("khaki1", "orange", "red3"))(n = 299)
ints= venn_table(preds, "intersect")
heatmap.2(ints, scale= "none", trace = "none", col = my_palette1, margins = c(6,6))
my_palette2 <- colorRampPalette(c("aliceblue", "cornflowerblue", "blue2"))(n = 299)
diff= venn_table(preds, "diff")
heatmap.2(diff, scale= "none", trace = "none", col = my_palette2, margins = c(6,6))
Path= "/home/poorya/Dropbox/PhD/embedding-integrator/Results/Predictions/"
Embeddings= c("line", "grarep", "sdne", "lle","hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "RF"
ytest= read.csv("/home/poorya/Dropbox/PhD/embedding-integrator/Results/Train_Test/drug_protein.ytest", header= F)
preds= c()
for(M in Embeddings){
pred= read.csv(paste0(Path, M, "_" , Model, "_prediction.csv"), header = F)[,1]
preds= cbind(preds, pred)
}
preds= cbind(preds, ytest)
colnames(preds)= c(Embeddings, "Test-set")
venn_table= function(preds, method){
Mat= matrix(0, ncol= ncol(preds), nrow= ncol(preds))
colnames(Mat)= colnames(preds)
rownames(Mat)= colnames(preds)
if (method == "intersect"){
for(i in colnames(preds)){
for(j in colnames(preds)){
x= sum(preds[,i] == preds[,j])
Mat[i,j]= x
Mat[j,i]= x
}}
} else {
for(i in colnames(preds)){
for(j in colnames(preds)){
x= sum(preds[,i] != preds[,j])
Mat[i,j]= x
Mat[j,i]= x
}}
}
return(Mat)}
library(gplots)
library("RColorBrewer")
preds
head(preds)
my_palette1 <- colorRampPalette(c("khaki1", "orange", "red3"))(n = 299)
ints= venn_table(preds, "intersect")
heatmap.2(ints, scale= "none", trace = "none", col = my_palette1, margins = c(6,6))
my_palette2 <- colorRampPalette(c("aliceblue", "cornflowerblue", "blue2"))(n = 299)
diff= venn_table(preds, "diff")
heatmap.2(diff, scale= "none", trace = "none", col = my_palette2, margins = c(6,6))
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Embeddings
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
for (emb in Embeddings){
print(emb)
}
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "NB"
xtrain= "Results/Predictions/Imbalance/"
paste0(xtrain + "/"+ emb + "_" + Model + "_prediction_proba.csv")
paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
setwd("~/Dropbox/PhD/embedding-integrator/")
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "NB"
xtrain= "Results/Predictions/Imbalance/"
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn)
head(xx)
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn, sep= " ")
head(xx)
xx= read.csv(nn, sep= " ", header = F)
head(xx)
xx[1,1]
xx[1,2]
setwd("~/Dropbox/PhD/embedding-integrator/")
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "NB"
xtrain= "Results/Predictions/Imbalance/"
kmean=c()
for (emb in Embeddings){
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn, sep= " ", header = F)
kmean= cbind(kmean, xx[,1])
}
dim(kmean)
head(kmean)
setwd("~/Dropbox/PhD/embedding-integrator/")
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "NB"
xtrain= "Results/Predictions/Imbalance/"
kmean=c()
for (emb in Embeddings){
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn, sep= " ", header = F)
kmean= cbind(kmean, xx[,1])
}
dist(kmean)
hc <- hclust(dist(kmean), "ave")
hc <- hclust(dist(t(kmean)), "ave")
head(hc)
gc
hc
plot(hc)
library(heatmaply)
install.packages("heatmaply")
library(heatmaply)
setwd("~/Dropbox/PhD/embedding-integrator/")
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "NB"
xtrain= "Results/Predictions/Imbalance/"
kmean=c()
for (emb in Embeddings){
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn, sep= " ", header = F)
kmean= cbind(kmean, xx[,1])
}
kmeans= t(kmean)
kmeans
my_cor <- cor(kmeans)
my_cor <- cor(kmean)
my_cor
heatmap(my_cor)
setwd("~/Dropbox/PhD/embedding-integrator/")
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "NB"
xtrain= "Results/Predictions/Imbalance/"
kmean=c()
for (emb in Embeddings){
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn, sep= " ", header = F)
kmean= cbind(kmean, xx[,1])
}
colnames(kmean)= Embeddings
kmeans= t(kmean)
my_cor <- cor(kmean)
kmean
head(kmean)
my_cor <- cor(kmean)
my_cor
heatmap(my_cor)
hc <- hclust(dist(kmeans), "ave")
hc
plot(hc)
setwd("~/Dropbox/PhD/embedding-integrator/")
Embeddings= c("line", "grarep", "sdne" ,"lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne")
Model= "XGB"
xtrain= "Results/Predictions/Imbalance/"
kmean=c()
for (emb in Embeddings){
nn= paste0(xtrain , "/", emb , "_" , Model , "_prediction_proba.csv")
xx= read.csv(nn, sep= " ", header = F)
kmean= cbind(kmean, xx[,1])
}
colnames(kmean)= Embeddings
kmeans= t(kmean)
hc <- hclust(dist(kmeans), "ave")
hc
my_cor <- cor(kmean)
heatmap(my_cor)
plot(hc)
kmean
head(kmean)
head(kmean, 10)
library(ggplot2)
library(RColorBrewer)
###############
## Prepare data
Methods= c("line", "grarep", "sdne", "lle", "hope", "lap", "deepwalk", "gf", "pca", "svd", "tsne", "Latefusion")
ROC_PR= c()
for(z in c("Imbalance","balance"))
for (i in Methods){
for (j in c("ROC", "PR")){
filename= paste0("~/Dropbox/PhD/embedding-integrator/Results/Predictions/", z, "/", i, "_XGB_", j, ".csv")
x= read.csv(file= filename, sep= "", header = F)
y= data.frame(x$V1, x$V2, i, j, z)
colnames(y)= c("V1", "V2", "Embedding", "Curve", "Data")
ROC_PR= rbind(ROC_PR, y)
}}
ROC_PR$Embedding= factor(ROC_PR$Embedding, levels = Methods)
ROC_PR$Curve= as.factor(ROC_PR$Curve)
ROC_PR$Data= as.factor(ROC_PR$Data)
#############
## Figure
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity") +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size=1) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size=0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size=0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour) +
layer(geom = "area"
)
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size=0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour) +
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size=0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size=0.3) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
linesize= rep(0.3, 10)
linesize
linesize= c(rep(0.3, 10), 1)
linesize
linesize
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
linesize= c(rep(0.3, 10), 1)
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size= linesize) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size= 0.3) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size= 0.3) +
geom_point(shape=21, color=colour, fill=colour, size=6) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
bp <- ggplot(aes(y = V2, x = V1, colour = Embedding), data = ROC_PR) +
geom_line(stat="identity", size= 0.3)
bp
bp <- ggplot(aes(y = V2, x = V1, fill = Embedding), data = ROC_PR) +
geom_line(stat="identity", size= 0.3)
bp
bp <- ggplot(aes(y = V2, x = V1, group = Embedding), data = ROC_PR) +
geom_line(stat="identity", size= 0.3)
bp
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size= 0.3) +
geom_point(shape=16, color=colour, fill=colour, size= 0.4)
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size= 0.3) +
#geom_point(shape=16, color=colour, fill=colour, size= 0.4) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot(ROC_PR, aes(y = V2, x = V1, colour = Embedding, group= Embedding) +
geom_line(stat="identity", size= 0.5) +
geom_point(shape=16, color=colour, fill=colour, size= 0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot(ROC_PR, aes(y = V2, x = V1, colour = Embedding, group= Embedding) +
geom_line(stat="identity", size= 0.5) +
geom_point(shape=16, color=colour, fill=colour, size= 0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
)
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot(ROC_PR, aes(y = V2, x = V1, colour = Embedding, group= Embedding)) +
geom_line(stat="identity", size= 0.5) +
geom_point(shape=16, color=colour, fill=colour, size= 0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour) +
theme_set(theme_bw())
bp
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
library(ggplot2)
bp <- ggplot() + geom_line(aes(y = V2, x = V1, colour = Embedding),
data = ROC_PR, stat="identity", size= 0.3) +
geom_point(shape=16, color=colour, fill=colour, size= 0.5) +
facet_grid(Data ~ Curve) +
scale_colour_manual(values=colour)+
theme_set(theme_bw())
bp
ggplot(aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
geom_point() +
geom_line() +
facet_wrap(Data ~ Curve)
diamonds %>%
diamonds %>%
group_by(Data, Curve) %>%
ggplot(aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
geom_point() +
geom_line() +
facet_wrap(Data ~ Curve)
ggplot(ROC_PR, aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
geom_point() +
geom_line() +
facet_wrap(Data ~ Curve)
bp <-  ggplot(ROC_PR, aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
geom_point() +
geom_line() +
facet_wrap(Data ~ Curve)
bp <-  ggplot(ROC_PR, aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
scale_colour_manual(values=colour)+
geom_point(shape=16, size= 0.5) +
geom_line() +
facet_wrap(Data ~ Curve) +
theme_set(theme_bw())
bp
bp <-  ggplot(ROC_PR, aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
scale_colour_manual(values=colour)+
geom_point(shape=16, size= 0.8) +
geom_line() +
facet_wrap(Data ~ Curve) +
theme_set(theme_bw())
bp
library(ggplot2)
colour= c("#9ebcda", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58", "#004529", "#fdd0a2", "#d7301f")
bp <-  ggplot(ROC_PR, aes(x = V1, y = V2, group = Embedding, color = Embedding)) +
scale_colour_manual(values=colour)+
geom_point(shape=16, size= 0.5) +
geom_line(size= 0.3) +
facet_wrap(Data ~ Curve) +
theme_set(theme_bw())
bp
x= 5
eval("x")
ge("x")
get("x")
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
head(a)[,1:5]
dim(a)
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
rownames(a)= paste0("D", 1:nrow(a))
head(a)[,1:6]
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("S", 1:nrow(a))
a
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("S", 1:ncol(a))
a
head(a)[,:16]
head(a)[,1:6]
dim(a)
colnames(a)
rownames(a)
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("S", 1:ncol(a))
a= a[1:20,1:20]
a
write.table(a, file = "~/Dropbox/BioNE/data/mat_drug_disease.txt", quote = F)
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
a
a= read.table("~/Dropbox/BioNE/data/mat_drug_protein.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("P", 1:ncol(a))
a
dim(a)
rownames(a)
colnames(a)
head(a)[,1:5]
a= read.table("~/Dropbox/BioNE/data/mat_drug_protein.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("P", 1:ncol(a))
a= a[1:20,1:20]
a
a= read.table("~/Dropbox/BioNE/data/mat_drug_protein.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("P", 1:ncol(a))
a= a[1:50,1:50]
a
table(a)
a
apply(a,1,sum)
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("S", 1:ncol(a))
a= a[1:50,1:50]
a\
a
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("S", 1:ncol(a))
a= a[1:50,1:50]
write.table(a, file = "~/Dropbox/BioNE/data/mat_drug_disease.txt", quote = F)
a= read.table("~/Dropbox/BioNE/data/mat_drug_protein.txt")
head(a)[,1:5]
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("P", 1:ncol(a))
dim(a)
a= a[1:50,1:50]
a
write.table(a, file = "~/Dropbox/BioNE/data/mat_drug_protein.txt", quote = F)
a= read.table("~/Dropbox/BioNE/data/mat_drug_se.txt")
head(a)[,1:5]
dim(a)
rownames(a)= paste0("D", 1:nrow(a))
colnames(a)= paste0("SE", 1:ncol(a))
a
a= a[1:50,1:50]
a
write.table(a, file = "~/Dropbox/BioNE/data/mat_drug_se.txt", quote = F)
a
a= read.table("~/Dropbox/BioNE/data/mat_protein_disease.txt")
rownames(a)= paste0("P", 1:nrow(a))
colnames(a)= paste0("S", 1:ncol(a))
a= a[1:50,1:50]
head(a)
a= read.table("~/Dropbox/BioNE/data/mat_protein_disease.txt")
head(a)
head(a)[,1:10]
dim(a)
a= read.table("~/Dropbox/BioNE/data/mat_protein_disease.txt")
rownames(a)= paste0("P", 1:nrow(a))
colnames(a)= paste0("S", 1:ncol(a))
a= a[1:50,1:50]
write.table(a, file = "~/Dropbox/BioNE/data/mat_protein_disease.txt", quote = F)
a= read.table("~/Dropbox/BioNE/data/mat_drug_se.txt")
dim(a)
table(a)
a
a == 1
sum(a == 1)
sum(a)
835 * 2
a= read.table("~/Dropbox/BioNE/data/mat_drug_disease.txt")
sum(a == 1)
968 * 2
head(a)
head(a)[,1;10]
head(a)[,1:10]
list.files()
setwd("~/Dropbox/BioNE/output/")
list.files()
a= read.table("~/Dropbox/BioNE/data/mat_drug_protein.txt")
head(a)
table(a)
sum(a)
dim(a)
a[1]
a[2]
as.matrix(a)
a= as.matrix(a)
a
a[1]
a[100]
a[2500]
a[2501]
sample(1:2500, 100, replace = F)
sample(1:2500, 200, replace = F)
a[sample(1:2500, 200, replace = F)]
a[sample(1:2500, 200, replace = F)]= 1
a
write.table(a, file = "~/Dropbox/da")
write.table(a, file = "~/Dropbox/BioNE/data/mat_drug_protein.txt", quote = F)
sum(a)
